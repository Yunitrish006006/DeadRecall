# âœ… å·²æ·»åŠ ç©å®¶æ­»äº¡æ¶ˆæ¯åˆ° Discord åŠŸèƒ½

## ğŸ¯ æ–°å¢åŠŸèƒ½

ç°åœ¨å½“ç©å®¶æ­»äº¡æ—¶ï¼Œä¼šè‡ªåŠ¨å‘é€æ¶ˆæ¯åˆ° Discordï¼

### ğŸ“ æ¶ˆæ¯å†…å®¹

æ­»äº¡æ¶ˆæ¯ä¼šåŒ…å«ï¼š
- ğŸ’€ **æ­»äº¡åŸå› **ï¼ˆä¾‹å¦‚ï¼šPlayer329 è¢«åƒµå°¸æ€æ­»äº†ï¼‰
- ğŸ“ **æ­»äº¡åº§æ ‡**ï¼ˆX, Y, Zï¼‰

### ç¤ºä¾‹æ¶ˆæ¯

```
ğŸ’€ Player329 è¢«åƒµå°¸æ€æ­»äº†
ğŸ“ åº§æ ‡: X=-550, Y=66, Z=10
```

---

## ğŸ”§ ä¿®æ”¹çš„æ–‡ä»¶

### `ServerPlayerEntityMixin.java`

åœ¨ç©å®¶æ­»äº¡æ—¶ï¼ˆ`onDeath` æ–¹æ³•ï¼‰ï¼Œæ·»åŠ äº†ï¼š

```java
// å‘é€æ­»äº¡æ¶ˆæ¯åˆ° Discord
String playerName = serverPlayer.getName().getString();
String deathMessage = source.getDeathMessage(serverPlayer).getString();
String location = String.format("åº§æ¨™: X=%d, Y=%d, Z=%d", pos.getX(), pos.getY(), pos.getZ());
String fullMessage = String.format("ğŸ’€ %s\nğŸ“ %s", deathMessage, location);

DiscordBridge.sendChatMessage(playerName, fullMessage);
```

**å·¥ä½œåŸç†**ï¼š
1. è·å–ç©å®¶åç§°
2. è·å– Minecraft çš„æ­»äº¡æ¶ˆæ¯ï¼ˆåŒ…å«æ­»å› ï¼‰
3. æ ¼å¼åŒ–åº§æ ‡ä¿¡æ¯
4. ç»„åˆæˆå®Œæ•´æ¶ˆæ¯å¹¶å‘é€åˆ° Discord

---

## ğŸš€ é‡æ–°æ„å»ºå¹¶éƒ¨ç½²

### åœ¨ IntelliJ IDEA ä¸­ï¼š

1. **Build â†’ Rebuild Project**
2. ç­‰å¾…æ„å»ºå®Œæˆ
3. æ£€æŸ¥ `build\libs\deadrecall-1.1.0.jar`

### æˆ–ä½¿ç”¨å‘½ä»¤è¡Œï¼š

```powershell
# è®¾ç½® JAVA_HOME
$env:JAVA_HOME = "C:\Users\yunth\.jdks\temurin-21.0.9"
$env:PATH = "$env:JAVA_HOME\bin;$env:PATH"

# æ„å»º
cd D:\dev\minecraft\DeadRecall
.\gradlew.bat clean build

# éƒ¨ç½²
Copy-Item "build\libs\deadrecall-1.1.0.jar" -Destination "$env:APPDATA\.minecraft\mods\" -Force
```

---

## ğŸ“‹ åŠŸèƒ½æ¸…å•

ç°åœ¨æ¨¡ç»„ä¼šå‘é€ä»¥ä¸‹æ¶ˆæ¯åˆ° Discordï¼š

- âœ… **èŠå¤©æ¶ˆæ¯**
  - æ ¼å¼ï¼š`<ç©å®¶å> æ¶ˆæ¯å†…å®¹`
  - ä¾‹å¦‚ï¼š`<Player329> Hello!`

- âœ… **æ­»äº¡æ¶ˆæ¯** â­ æ–°å¢
  - æ ¼å¼ï¼š
    ```
    ğŸ’€ æ­»äº¡åŸå› 
    ğŸ“ åº§æ ‡: X=?, Y=?, Z=?
    ```
  - ä¾‹å¦‚ï¼š
    ```
    ğŸ’€ Player329 ä»é«˜å¤„æ‘”è½
    ğŸ“ åº§æ ‡: X=123, Y=64, Z=-456
    ```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. é‡æ–°æ„å»ºæ¨¡ç»„

åœ¨ IntelliJ IDEA ä¸­ï¼š
- Build â†’ Rebuild Project

### 2. éƒ¨ç½²åˆ° Minecraft

```powershell
Copy-Item "build\libs\deadrecall-1.1.0.jar" -Destination "<ä½ çš„Minecraftè·¯å¾„>\mods\" -Force
```

### 3. ç¡®ä¿ Discord Bridge å·²å¯ç”¨

æ£€æŸ¥é…ç½®æ–‡ä»¶ `discord-bridge.json`ï¼š
```json
{
  "enabled": true,
  "workerUrl": "https://mc-discord-bot.yunitrish0419.workers.dev",
  "apiKey": "mc_ak_7Xp9Qm3vKsW2nF8jRtYb6LdA4eHcZu"
}
```

### 4. é‡å¯ Minecraft

### 5. æµ‹è¯•

#### æµ‹è¯•èŠå¤©æ¶ˆæ¯ï¼š
åœ¨æ¸¸æˆä¸­å‘é€èŠå¤©æ¶ˆæ¯

#### æµ‹è¯•æ­»äº¡æ¶ˆæ¯ï¼š
- æ•…æ„è®©è§’è‰²æ­»äº¡ï¼ˆè·³æ¥¼ã€è¢«æ€ªç‰©æ”»å‡»ç­‰ï¼‰
- æ£€æŸ¥ Discord é¢‘é“æ˜¯å¦æ”¶åˆ°æ­»äº¡æ¶ˆæ¯

### 6. æŸ¥çœ‹æ—¥å¿—

Minecraft æ—¥å¿—åº”è¯¥æ˜¾ç¤ºï¼š
```
[DeadRecall] [DiscordBridge] å·²å¯ç”¨ï¼ŒWorker URL: https://...
[DiscordBridge] å‘é€è¯·æ±‚åˆ°: https://...
[DiscordBridge] JSON å†…å®¹: {"username":"Player329","message":"ğŸ’€ Player329..."}
[DiscordBridge] å‘é€æˆåŠŸ (HTTP 200): {"success":true,"data":{"sent":1,"failed":0}}
```

---

## ğŸ’¡ æ¶ˆæ¯æ ¼å¼è¯´æ˜

### ä¸ºä»€ä¹ˆä½¿ç”¨ `\n` æ¢è¡Œï¼Ÿ

æ­»äº¡æ¶ˆæ¯ä½¿ç”¨ä¸¤è¡Œæ˜¾ç¤ºï¼š
- ç¬¬ä¸€è¡Œï¼šğŸ’€ + æ­»äº¡åŸå› 
- ç¬¬äºŒè¡Œï¼šğŸ“ + åº§æ ‡

åœ¨ Discord ä¸­æ˜¾ç¤ºä¸ºï¼š
```
Player329
ğŸ’€ Player329 ä»é«˜å¤„æ‘”è½
ğŸ“ åº§æ ‡: X=123, Y=64, Z=-456
```

### å¯ä»¥è‡ªå®šä¹‰å—ï¼Ÿ

æ˜¯çš„ï¼åœ¨ `ServerPlayerEntityMixin.java` ä¸­ä¿®æ”¹è¿™ä¸€è¡Œï¼š
```java
String fullMessage = String.format("ğŸ’€ %s\nğŸ“ %s", deathMessage, location);
```

ä¾‹å¦‚æ”¹æˆï¼š
```java
// ç®€æ´ç‰ˆ
String fullMessage = String.format("%s æ­»åœ¨ (%d, %d, %d)", 
    playerName, pos.getX(), pos.getY(), pos.getZ());

// è¯¦ç»†ç‰ˆ
String fullMessage = String.format("â˜ ï¸ ç©å®¶æ­»äº¡\nç©å®¶ï¼š%s\nåŸå› ï¼š%s\nä½ç½®ï¼šX=%d, Y=%d, Z=%d", 
    playerName, deathMessage, pos.getX(), pos.getY(), pos.getZ());
```

---

## ğŸ® Discord æ˜¾ç¤ºç¤ºä¾‹

### èŠå¤©æ¶ˆæ¯
```
Minecraft Server
Player329: Hello everyone!
```

### æ­»äº¡æ¶ˆæ¯
```
Minecraft Server
Player329
ğŸ’€ Player329 è¢«åƒµå°¸æ€æ­»äº†
ğŸ“ åº§æ ‡: X=-550, Y=66, Z=10
```

---

## ğŸ› æ•…éšœæ’é™¤

### å¦‚æœæ­»äº¡æ¶ˆæ¯æ²¡æœ‰å‘é€

1. **æ£€æŸ¥æ—¥å¿—**
   - æŸ¥çœ‹æ˜¯å¦æœ‰ `[DiscordBridge]` ç›¸å…³æ—¥å¿—
   - ç¡®è®¤ "å·²å¯ç”¨" è€Œä¸æ˜¯ "åŠŸèƒ½å·²åœç”¨"

2. **æ£€æŸ¥é…ç½®**
   - ç¡®ä¿ `enabled: true`
   - ç¡®ä¿ `workerUrl` å’Œ `apiKey` æ­£ç¡®

3. **æ£€æŸ¥ Worker**
   - æµ‹è¯• Worker API æ˜¯å¦æ­£å¸¸
   - æ£€æŸ¥ Discord Webhook æ˜¯å¦æœ‰æ•ˆ

4. **æ£€æŸ¥ç¼–è¯‘**
   - ç¡®ä¿é‡æ–°æ„å»ºåéƒ¨ç½²äº†æ–°çš„ JAR
   - æ£€æŸ¥ JAR æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | ä¹‹å‰ | ç°åœ¨ |
|------|------|------|
| èŠå¤©æ¶ˆæ¯ | âœ… | âœ… |
| æ­»äº¡æ¶ˆæ¯ | âŒ | âœ… â­ |
| æ­»äº¡åº§æ ‡ | âœ… æœ¬åœ°è®°å½• | âœ… Discord + æœ¬åœ° |
| /back æŒ‡ä»¤ | âœ… | âœ… |

---

## ğŸ‰ æ€»ç»“

âœ… **å·²æ·»åŠ åŠŸèƒ½**ï¼šç©å®¶æ­»äº¡æ—¶è‡ªåŠ¨å‘é€æ¶ˆæ¯åˆ° Discord

âœ… **æ¶ˆæ¯å†…å®¹**ï¼š
- æ­»äº¡åŸå› ï¼ˆæ¥è‡ª Minecraftï¼‰
- æ­»äº¡åº§æ ‡

âœ… **ä¸‹ä¸€æ­¥**ï¼š
1. åœ¨ IntelliJ IDEA ä¸­é‡æ–°æ„å»º
2. éƒ¨ç½²æ–°çš„ JAR åˆ° Minecraft
3. ç¡®ä¿ Discord Bridge é…ç½®æ­£ç¡®å¹¶å¯ç”¨
4. é‡å¯æ¸¸æˆæµ‹è¯•

**ç°åœ¨é‡æ–°æ„å»ºå¹¶æµ‹è¯•æ­»äº¡æ¶ˆæ¯åŠŸèƒ½å§ï¼** ğŸš€
