# ğŸ¯ Discord Bridge å•é¡Œè§£æ±ºæ–¹æ¡ˆ

## âœ… å¥½æ¶ˆæ¯ï¼šMinecraft ç«¯å®Œå…¨æ­£å¸¸ï¼

å¾æ—¥èªŒå¯ä»¥ç¢ºèªï¼š
```
[DiscordBridge] ç™¼é€æˆåŠŸ (HTTP 200): {"success":true,"data":{"sent":0,"failed":2}}
```

**é€™è¡¨ç¤º**ï¼š
- âœ… Minecraft æˆåŠŸé€£æ¥åˆ° Cloudflare Worker
- âœ… Worker æ”¶åˆ°è«‹æ±‚ä¸¦æ­£ç¢ºè™•ç†
- âœ… Worker å›æ‡‰ HTTP 200ï¼ˆæˆåŠŸï¼‰
- âŒ **ä½† Worker ç„¡æ³•å°‡è¨Šæ¯ç™¼é€åˆ° Discord**ï¼ˆsent: 0, failed: 2ï¼‰

---

## ğŸ¯ å•é¡Œæ ¹æº

**å•é¡Œ 100% åœ¨ Cloudflare Worker ç«¯**ï¼Œå…·é«”æ˜¯ï¼š

### Discord Webhook é…ç½®å•é¡Œ

Worker å˜—è©¦ç™¼é€åˆ° 2 å€‹ Discord é »é“ï¼Œä½†éƒ½å¤±æ•—äº†ã€‚æœ€å¯èƒ½çš„åŸå› ï¼š

1. **Discord Webhook URL ç„¡æ•ˆæˆ–éæœŸ** â­â­â­ ï¼ˆæœ€å¯èƒ½ï¼‰
2. Webhook æ¬Šé™ä¸è¶³
3. Worker ç’°å¢ƒè®Šæ•¸é…ç½®éŒ¯èª¤
4. Discord API é™åˆ¶æˆ–éŒ¯èª¤

---

## ğŸ”§ ç«‹å³è§£æ±ºæ­¥é©Ÿ

### ç¬¬ 1 æ­¥ï¼šæª¢æŸ¥ Discord Webhook

1. é–‹å•Ÿ Discord
2. å‰å¾€ä½ æƒ³æ¥æ”¶ Minecraft è¨Šæ¯çš„é »é“
3. é»æ“Šé »é“è¨­å®šï¼ˆé½’è¼ªåœ–æ¨™ï¼‰
4. é¸æ“‡ã€Œæ•´åˆã€(Integrations) â†’ ã€ŒWebhooksã€
5. æª¢æŸ¥æ˜¯å¦æœ‰ Webhookï¼Œæˆ–**å‰µå»ºæ–°çš„ Webhook**ï¼š
   - é»æ“Šã€Œæ–°å¢ Webhookã€æˆ–ã€ŒCreate Webhookã€
   - å‘½åï¼ˆä¾‹å¦‚ï¼šMinecraft Chatï¼‰
   - **è¤‡è£½ Webhook URL**ï¼ˆæ ¼å¼ï¼š`https://discord.com/api/webhooks/æ•¸å­—/å­—ä¸²`ï¼‰

### ç¬¬ 2 æ­¥ï¼šæ¸¬è©¦ Webhookï¼ˆç¢ºèªæœ‰æ•ˆæ€§ï¼‰

é–‹å•Ÿ PowerShellï¼ŒåŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
# æ›¿æ›æˆä½ çš„ Webhook URL
$webhook = "https://discord.com/api/webhooks/ä½ çš„webhook_id/ä½ çš„webhook_token"

$body = @{
    content = "âœ… Webhook æ¸¬è©¦æˆåŠŸï¼"
    username = "æ¸¬è©¦æ©Ÿå™¨äºº"
} | ConvertTo-Json

Invoke-RestMethod -Uri $webhook -Method POST -Body $body -ContentType "application/json"
```

å¦‚æœ Discord æ”¶åˆ°è¨Šæ¯ï¼Œè¡¨ç¤º Webhook æœ‰æ•ˆ âœ…

### ç¬¬ 3 æ­¥ï¼šæ›´æ–° Cloudflare Worker è¨­å®š

1. ç™»å…¥ [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. å‰å¾€ **Workers & Pages**
3. é¸æ“‡ä½ çš„ Workerï¼ˆ`mc-discord-bot`ï¼‰
4. é»æ“Š **Settings** â†’ **Variables**
5. æ‰¾åˆ°æˆ–æ–°å¢ `DISCORD_WEBHOOK_URLS` ç’°å¢ƒè®Šæ•¸
6. **è¨­å®šç‚º JSON é™£åˆ—æ ¼å¼**ï¼š
   ```json
   ["https://discord.com/api/webhooks/ä½ çš„webhook_id/ä½ çš„webhook_token"]
   ```
   å¦‚æœæœ‰å¤šå€‹é »é“ï¼š
   ```json
   ["https://discord.com/api/webhooks/xxx/yyy","https://discord.com/api/webhooks/aaa/bbb"]
   ```
7. é»æ“Š **Encrypt** å’Œ **Save**
8. **é‡æ–°éƒ¨ç½² Worker**ï¼ˆé€šå¸¸æœƒè‡ªå‹•éƒ¨ç½²ï¼‰

### ç¬¬ 4 æ­¥ï¼šé©—è­‰ä¿®å¾©

1. å›åˆ° Minecraft
2. åœ¨èŠå¤©æ¡†è¼¸å…¥ä»»ä½•è¨Šæ¯
3. æª¢æŸ¥ Discord é »é“æ˜¯å¦æ”¶åˆ°è¨Šæ¯
4. æª¢æŸ¥ `run/logs/latest.log`ï¼Œæ‡‰è©²çœ‹åˆ°ï¼š
   ```
   [DiscordBridge] ç™¼é€æˆåŠŸ (HTTP 200): {"success":true,"data":{"sent":1,"failed":0}}
   ```
   æˆ–
   ```
   [DiscordBridge] ç™¼é€æˆåŠŸ (HTTP 200): {"success":true,"data":{"sent":2,"failed":0}}
   ```

---

## ğŸ“‹ é€²éšé™¤éŒ¯

### ä½¿ç”¨æ¸¬è©¦è…³æœ¬

æˆ‘å·²ç¶“ç‚ºä½ å‰µå»ºäº†æ¸¬è©¦è…³æœ¬ï¼ŒåŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
cd D:\dev\minecraft\DeadRecall
.\test-discord-api.ps1
```

é€™æœƒæ¸¬è©¦æ•´å€‹æµç¨‹ä¸¦é¡¯ç¤ºè©³ç´°çµæœã€‚

### æŸ¥çœ‹ Worker æ—¥èªŒ

å¦‚æœä½ æœ‰ `wrangler` CLIï¼š

```bash
wrangler tail mc-discord-bot
```

ç„¶å¾Œåœ¨ Minecraft ç™¼é€è¨Šæ¯ï¼Œå³æ™‚æŸ¥çœ‹ Worker çš„æ—¥èªŒè¼¸å‡ºã€‚

### æª¢æŸ¥ Worker ç¨‹å¼ç¢¼

æˆ‘å·²ç¶“å‰µå»ºäº†ä¸€å€‹å®Œæ•´çš„ Worker ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼š
- æª”æ¡ˆï¼š`cloudflare-worker-example.js`
- åŒ…å«å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„
- å¯ä»¥ç›´æ¥ä½¿ç”¨æˆ–åƒè€ƒä¿®æ”¹

---

## ğŸ¬ é æœŸçµæœ

ä¿®å¾©å¾Œï¼Œæ—¥èªŒæ‡‰è©²é¡¯ç¤ºï¼š

```
[DiscordBridge] ç™¼é€è«‹æ±‚åˆ°: https://mc-discord-bot.yunitrish0419.workers.dev/api/mc/chat
[DiscordBridge] API Key: mc_ak_7Xp9...
[DiscordBridge] JSON å…§å®¹: {"username":"Player329","message":"æ¸¬è©¦è¨Šæ¯"}
[DiscordBridge] ç™¼é€æˆåŠŸ (HTTP 200): {"success":true,"data":{"sent":1,"failed":0}}
                                                                    â†‘ æˆåŠŸï¼
```

Discord é »é“æœƒæ”¶åˆ°ï¼š
```
Minecraft Server  (æ©Ÿå™¨äººåç¨±)
**Player329**: æ¸¬è©¦è¨Šæ¯
```

---

## ğŸ“ å¦‚æœé‚„æ˜¯ç„¡æ³•è§£æ±º

æä¾›ä»¥ä¸‹è³‡è¨Šä»¥ä¾¿é€²ä¸€æ­¥å”åŠ©ï¼š

1. âœ… Webhook æ¸¬è©¦çµæœï¼ˆç¬¬ 2 æ­¥ï¼‰
2. âœ… Cloudflare Worker ç’°å¢ƒè®Šæ•¸æˆªåœ–
3. âœ… Worker æ—¥èªŒè¼¸å‡ºï¼ˆä½¿ç”¨ `wrangler tail`ï¼‰
4. âœ… åŸ·è¡Œ `test-discord-api.ps1` çš„è¼¸å‡º

---

## ğŸ“ ç›¸é—œæª”æ¡ˆ

æˆ‘å·²ç¶“å‰µå»ºäº†ä»¥ä¸‹æª”æ¡ˆä¾›ä½ åƒè€ƒï¼š

1. **`test-discord-api.ps1`** - API æ¸¬è©¦è…³æœ¬
2. **`DISCORD_BRIDGE_è¨ºæ–·å ±å‘Š.md`** - å®Œæ•´è¨ºæ–·å ±å‘Š
3. **`cloudflare-worker-example.js`** - Worker ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼ˆåŒ…å«å®Œæ•´éŒ¯èª¤è™•ç†ï¼‰
4. **`å¿«é€Ÿè§£æ±ºæ–¹æ¡ˆ.md`** - æœ¬æª”æ¡ˆ

---

## âœ¨ ç¸½çµ

| é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| Minecraft ç«¯ | âœ… æ­£å¸¸ | ç¨‹å¼ç¢¼é‹ä½œå®Œç¾ |
| ç¶²è·¯é€£æ¥ | âœ… æ­£å¸¸ | æˆåŠŸé€£æ¥åˆ° Worker |
| Worker API | âœ… æ­£å¸¸ | æ­£ç¢ºæ¥æ”¶å’Œå›æ‡‰è«‹æ±‚ |
| Discord Webhook | âŒ **éœ€è¦ä¿®å¾©** | Webhook é…ç½®å•é¡Œ |

**è§£æ±ºæ–¹æ¡ˆï¼šæ›´æ–° Cloudflare Worker çš„ DISCORD_WEBHOOK_URLS ç’°å¢ƒè®Šæ•¸**

---

**åŠ æ²¹ï¼å•é¡Œå¾ˆå¿«å°±èƒ½è§£æ±ºäº†ï¼** ğŸš€
